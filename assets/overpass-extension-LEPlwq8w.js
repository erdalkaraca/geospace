import{I as Et}from"./index-C9fhvFKW.js";var it={exports:{}};/**
 * @license
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash exports="node" include="clone,merge,isEmpty,isArray,compact,each" -d`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Vr=it.exports,An;function kr(){return An||(An=1,function(v,ae){(function(){var _,R="4.15.0",Y=200,D="Expected a function",O="__lodash_hash_undefined__",g=1,L=2,Z=9007199254740991,j="[object Arguments]",X="[object Array]",fe="[object Boolean]",ye="[object Date]",B="[object Error]",l="[object Function]",u="[object GeneratorFunction]",M="[object Map]",A="[object Number]",J="[object Object]",le="[object Promise]",i="[object RegExp]",G="[object Set]",T="[object String]",P="[object Symbol]",d="[object WeakMap]",S="[object ArrayBuffer]",f="[object DataView]",c="[object Float32Array]",h="[object Float64Array]",a="[object Int8Array]",w="[object Int16Array]",N="[object Int32Array]",I="[object Uint8Array]",F="[object Uint8ClampedArray]",ue="[object Uint16Array]",W="[object Uint32Array]",ot=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Be=/^\w*$/,Ve=/^\./,ke=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,me=/[\\^$.*+?()[\]{}|]/g,Ne=/\\(\\)?/g,je=/\w*$/,z=/^\[object .+?Constructor\]$/,oe=/^(?:0|[1-9]\d*)$/,y={};y[c]=y[h]=y[a]=y[w]=y[N]=y[I]=y[F]=y[ue]=y[W]=!0,y[j]=y[X]=y[S]=y[fe]=y[f]=y[ye]=y[B]=y[l]=y[M]=y[A]=y[J]=y[i]=y[G]=y[T]=y[d]=!1;var b={};b[j]=b[X]=b[S]=b[f]=b[fe]=b[ye]=b[c]=b[h]=b[a]=b[w]=b[N]=b[M]=b[A]=b[J]=b[i]=b[G]=b[T]=b[P]=b[I]=b[F]=b[ue]=b[W]=!0,b[B]=b[l]=b[d]=!1;var ce=typeof Et=="object"&&Et&&Et.Object===Object&&Et,Te=typeof self=="object"&&self&&self.Object===Object&&self,$=ce||Te||Function("return this")(),ee=ae&&!ae.nodeType&&ae,U=ee&&!0&&v&&!v.nodeType&&v,re=U&&U.exports===ee,ve=re&&ce.process,De=function(){try{return ve&&ve.binding("util")}catch{}}(),at=De&&De.isTypedArray;function We(e,t){return e.set(t[0],t[1]),e}function ut(e,t){return e.add(t),e}function Ee(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function qe(e,t){for(var n=-1,r=e?e.length:0;++n<r&&t(e[n],n,e)!==!1;);return e}function st(e,t){for(var n=-1,r=t.length,s=e.length;++n<r;)e[s+n]=t[n];return e}function H(e,t,n,r){for(var s=-1,o=e?e.length:0;++s<o;)n=t(n,e[s],s,e);return n}function de(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(t(e[n],n,e))return!0;return!1}function _e(e){return function(t){return t==null?_:t[e]}}function $e(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Me(e){return function(t){return e(t)}}function ft(e,t){return e==null?_:e[t]}function se(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}function te(e){var t=-1,n=Array(e.size);return e.forEach(function(r,s){n[++t]=[s,r]}),n}function be(e,t){return function(n){return e(t(n))}}function Ie(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var et=Array.prototype,Ue=Function.prototype,Se=Object.prototype,He=$["__core-js_shared__"],Ke=function(){var e=/[^.]+$/.exec(He&&He.keys&&He.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Xe=Ue.toString,V=Se.hasOwnProperty,St=Xe.call(Object),Re=Se.toString,En=RegExp("^"+Xe.call(V).replace(me,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ut=re?$.Buffer:_,Ht=$.Symbol,lt=$.Uint8Array,Kt=be(Object.getPrototypeOf,Object),Sn=Object.create,Xt=Se.propertyIsEnumerable,xn=et.splice,Jt=Object.getOwnPropertySymbols,Pn=Ut?Ut.isBuffer:_,Yt=be(Object.keys,Object),Zt=Math.max,xt=Ye($,"DataView"),tt=Ye($,"Map"),Pt=Ye($,"Promise"),Nt=Ye($,"Set"),Mt=Ye($,"WeakMap"),nt=Ye(Object,"create"),Nn=!Xt.call({valueOf:1},"valueOf"),Mn=Ge(xt),In=Ge(tt),Rn=Ge(Pt),Cn=Ge(Nt),Gn=Ge(Mt),ct=Ht?Ht.prototype:_,rt=ct?ct.valueOf:_,Qt=ct?ct.toString:_;function x(){}function Ce(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Fn(){this.__data__=nt?nt(null):{}}function Ln(e){return this.has(e)&&delete this.__data__[e]}function Bn(e){var t=this.__data__;if(nt){var n=t[e];return n===O?_:n}return V.call(t,e)?t[e]:_}function Dn(e){var t=this.__data__;return nt?t[e]!==_:V.call(t,e)}function Wn(e,t){var n=this.__data__;return n[e]=nt&&t===_?O:t,this}Ce.prototype.clear=Fn,Ce.prototype.delete=Ln,Ce.prototype.get=Bn,Ce.prototype.has=Dn,Ce.prototype.set=Wn;function Ae(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function qn(){this.__data__=[]}function $n(e){var t=this.__data__,n=pt(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():xn.call(t,n,1),!0}function Un(e){var t=this.__data__,n=pt(t,e);return n<0?_:t[n][1]}function Hn(e){return pt(this.__data__,e)>-1}function Kn(e,t){var n=this.__data__,r=pt(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}Ae.prototype.clear=qn,Ae.prototype.delete=$n,Ae.prototype.get=Un,Ae.prototype.has=Hn,Ae.prototype.set=Kn;function we(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Xn(){this.__data__={hash:new Ce,map:new(tt||Ae),string:new Ce}}function Jn(e){return gt(this,e).delete(e)}function Yn(e){return gt(this,e).get(e)}function Zn(e){return gt(this,e).has(e)}function Qn(e,t){return gt(this,e).set(e,t),this}we.prototype.clear=Xn,we.prototype.delete=Jn,we.prototype.get=Yn,we.prototype.has=Zn,we.prototype.set=Qn;function dt(e){var t=-1,n=e?e.length:0;for(this.__data__=new we;++t<n;)this.add(e[t])}function zn(e){return this.__data__.set(e,O),this}function Vn(e){return this.__data__.has(e)}dt.prototype.add=dt.prototype.push=zn,dt.prototype.has=Vn;function pe(e){this.__data__=new Ae(e)}function kn(){this.__data__=new Ae}function jn(e){return this.__data__.delete(e)}function er(e){return this.__data__.get(e)}function tr(e){return this.__data__.has(e)}function nr(e,t){var n=this.__data__;if(n instanceof Ae){var r=n.__data__;if(!tt||r.length<Y-1)return r.push([e,t]),this;n=this.__data__=new we(r)}return n.set(e,t),this}pe.prototype.clear=kn,pe.prototype.delete=jn,pe.prototype.get=er,pe.prototype.has=tr,pe.prototype.set=nr;function zt(e,t){var n=ie(e)||Qe(e)?$e(e.length,String):[],r=n.length,s=!!r;for(var o in e)(t||V.call(e,o))&&!(s&&(o=="length"||Ft(o,r)))&&n.push(o);return n}function It(e,t,n){(n!==_&&!Ze(e[t],n)||typeof t=="number"&&n===_&&!(t in e))&&(e[t]=n)}function Vt(e,t,n){var r=e[t];(!(V.call(e,t)&&Ze(r,n))||n===_&&!(t in e))&&(e[t]=n)}function pt(e,t){for(var n=e.length;n--;)if(Ze(e[n][0],t))return n;return-1}function rr(e,t){return e&&Gt(t,xe(t),e)}function Je(e,t,n,r,s,o,p){var m;if(r&&(m=o?r(e,s,o,p):r(e)),m!==_)return m;if(!ge(e))return e;var E=ie(e);if(E){if(m=Wr(e),!t)return rn(e,m)}else{var q=he(e),C=q==l||q==u;if(Bt(e))return wr(e,t);if(q==J||q==j||C&&!o){if(se(e))return o?e:{};if(m=qr(C?{}:e),!t)return Nr(e,rr(m,e))}else{if(!b[q])return o?e:{};m=$r(e,q,Je,t)}}p||(p=new pe);var K=p.get(e);if(K)return K;if(p.set(e,m),!E)var Q=n?Fr(e):xe(e);return qe(Q||e,function(ne,k){Q&&(k=ne,ne=e[k]),Vt(m,k,Je(ne,t,n,r,k,e,p))}),m}function ir(e){return ge(e)?Sn(e):{}}var or=Ir(ur),ar=Rr();function ur(e,t){return e&&ar(e,t,xe)}function kt(e,t){t=yt(t,e)?[t]:nn(t);for(var n=0,r=t.length;e!=null&&n<r;)e=e[mt(t[n++])];return n&&n==r?e:_}function sr(e,t,n){var r=t(e);return ie(e)?r:st(r,n(e))}function fr(e){return Re.call(e)}function lr(e,t){return e!=null&&t in Object(e)}function Rt(e,t,n,r,s){return e===t?!0:e==null||t==null||!ge(e)&&!ze(t)?e!==e&&t!==t:cr(e,t,Rt,n,r,s)}function cr(e,t,n,r,s,o){var p=ie(e),m=ie(t),E=X,q=X;p||(E=he(e),E=E==j?J:E),m||(q=he(t),q=q==j?J:q);var C=E==J&&!se(e),K=q==J&&!se(t),Q=E==q;if(Q&&!C)return o||(o=new pe),p||wt(e)?on(e,t,n,r,s,o):Cr(e,t,E,n,r,s,o);if(!(s&L)){var ne=C&&V.call(e,"__wrapped__"),k=K&&V.call(t,"__wrapped__");if(ne||k){var Pe=ne?e.value():e,Oe=k?t.value():t;return o||(o=new pe),n(Pe,Oe,r,s,o)}}return Q?(o||(o=new pe),Gr(e,t,n,r,s,o)):!1}function dr(e,t,n,r){var s=n.length,o=s;if(e==null)return!o;for(e=Object(e);s--;){var p=n[s];if(p[2]?p[1]!==e[p[0]]:!(p[0]in e))return!1}for(;++s<o;){p=n[s];var m=p[0],E=e[m],q=p[1];if(p[2]){if(E===_&&!(m in e))return!1}else{var C=new pe,K;if(!(K===_?Rt(q,E,r,g|L,C):K))return!1}}return!0}function pr(e){if(!ge(e)||Kr(e))return!1;var t=_t(e)||se(e)?En:z;return t.test(Ge(e))}function gr(e){return ze(e)&&bt(e.length)&&!!y[Re.call(e)]}function jt(e){return typeof e=="function"?e:e==null?hn:typeof e=="object"?ie(e)?mr(e[0],e[1]):hr(e):mn(e)}function yr(e){if(!ht(e))return Yt(e);var t=[];for(var n in Object(e))V.call(e,n)&&n!="constructor"&&t.push(n);return t}function en(e){if(!ge(e))return Xr(e);var t=ht(e),n=[];for(var r in e)r=="constructor"&&(t||!V.call(e,r))||n.push(r);return n}function hr(e){var t=Br(e);return t.length==1&&t[0][2]?sn(t[0][0],t[0][1]):function(n){return n===e||dr(n,e,t)}}function mr(e,t){return yt(e)&&un(t)?sn(mt(e),t):function(n){var r=pn(n,e);return r===_&&r===t?gn(n,e):Rt(t,r,_,g|L)}}function tn(e,t,n,r,s){if(e!==t){if(!(ie(t)||wt(t)))var o=en(t);qe(o||t,function(p,m){if(o&&(m=p,p=t[m]),ge(p))s||(s=new pe),vr(e,t,m,n,tn,r,s);else{var E=r?r(e[m],p,m+"",e,t,s):_;E===_&&(E=p),It(e,m,E)}})}}function vr(e,t,n,r,s,o,p){var m=e[n],E=t[n],q=p.get(E);if(q){It(e,n,q);return}var C=o?o(m,E,n+"",e,t,p):_,K=C===_;K&&(C=E,ie(E)||wt(E)?ie(m)?C=m:Lt(m)?C=rn(m):(K=!1,C=Je(E,!0)):ln(E)||Qe(E)?Qe(m)?C=cn(m):!ge(m)||r&&_t(m)?(K=!1,C=Je(E,!0)):C=m:K=!1),K&&(p.set(E,C),s(C,E,r,o,p),p.delete(E)),It(e,n,C)}function _r(e){return function(t){return kt(t,e)}}function br(e,t){return t=Zt(t===_?e.length-1:t,0),function(){for(var n=arguments,r=-1,s=Zt(n.length-t,0),o=Array(s);++r<s;)o[r]=n[t+r];r=-1;for(var p=Array(t+1);++r<t;)p[r]=n[r];return p[t]=o,Ee(e,this,p)}}function Ar(e){if(typeof e=="string")return e;if(At(e))return Qt?Qt.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function nn(e){return ie(e)?e:Jr(e)}function wr(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}function Ct(e){var t=new e.constructor(e.byteLength);return new lt(t).set(new lt(e)),t}function Or(e,t){var n=t?Ct(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Tr(e,t,n){var r=t?n(te(e),!0):te(e);return H(r,We,new e.constructor)}function Er(e){var t=new e.constructor(e.source,je.exec(e));return t.lastIndex=e.lastIndex,t}function Sr(e,t,n){var r=t?n(Ie(e),!0):Ie(e);return H(r,ut,new e.constructor)}function xr(e){return rt?Object(rt.call(e)):{}}function Pr(e,t){var n=t?Ct(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function rn(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function Gt(e,t,n,r){n||(n={});for(var s=-1,o=t.length;++s<o;){var p=t[s],m=_;Vt(n,p,m===_?e[p]:m)}return n}function Nr(e,t){return Gt(e,an(e),t)}function Mr(e){return br(function(t,n){var r=-1,s=n.length,o=s>1?n[s-1]:_,p=s>2?n[2]:_;for(o=e.length>3&&typeof o=="function"?(s--,o):_,p&&Ur(n[0],n[1],p)&&(o=s<3?_:o,s=1),t=Object(t);++r<s;){var m=n[r];m&&e(t,m,r,o)}return t})}function Ir(e,t){return function(n,r){if(n==null)return n;if(!Fe(n))return e(n,r);for(var s=n.length,o=-1,p=Object(n);++o<s&&r(p[o],o,p)!==!1;);return n}}function Rr(e){return function(t,n,r){for(var s=-1,o=Object(t),p=r(t),m=p.length;m--;){var E=p[++s];if(n(o[E],E,o)===!1)break}return t}}function on(e,t,n,r,s,o){var p=s&L,m=e.length,E=t.length;if(m!=E&&!(p&&E>m))return!1;var q=o.get(e);if(q&&o.get(t))return q==t;var C=-1,K=!0,Q=s&g?new dt:_;for(o.set(e,t),o.set(t,e);++C<m;){var ne=e[C],k=t[C];if(r)var Pe=p?r(k,ne,C,t,e,o):r(ne,k,C,e,t,o);if(Pe!==_){if(Pe)continue;K=!1;break}if(Q){if(!de(t,function(Oe,Le){if(!Q.has(Le)&&(ne===Oe||n(ne,Oe,r,s,o)))return Q.add(Le)})){K=!1;break}}else if(!(ne===k||n(ne,k,r,s,o))){K=!1;break}}return o.delete(e),o.delete(t),K}function Cr(e,t,n,r,s,o,p){switch(n){case f:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case S:return!(e.byteLength!=t.byteLength||!r(new lt(e),new lt(t)));case fe:case ye:case A:return Ze(+e,+t);case B:return e.name==t.name&&e.message==t.message;case i:case T:return e==t+"";case M:var m=te;case G:var E=o&L;if(m||(m=Ie),e.size!=t.size&&!E)return!1;var q=p.get(e);if(q)return q==t;o|=g,p.set(e,t);var C=on(m(e),m(t),r,s,o,p);return p.delete(e),C;case P:if(rt)return rt.call(e)==rt.call(t)}return!1}function Gr(e,t,n,r,s,o){var p=s&L,m=xe(e),E=m.length,q=xe(t),C=q.length;if(E!=C&&!p)return!1;for(var K=E;K--;){var Q=m[K];if(!(p?Q in t:V.call(t,Q)))return!1}var ne=o.get(e);if(ne&&o.get(t))return ne==t;var k=!0;o.set(e,t),o.set(t,e);for(var Pe=p;++K<E;){Q=m[K];var Oe=e[Q],Le=t[Q];if(r)var bn=p?r(Le,Oe,Q,t,e,o):r(Oe,Le,Q,e,t,o);if(!(bn===_?Oe===Le||n(Oe,Le,r,s,o):bn)){k=!1;break}Pe||(Pe=Q=="constructor")}if(k&&!Pe){var Ot=e.constructor,Tt=t.constructor;Ot!=Tt&&"constructor"in e&&"constructor"in t&&!(typeof Ot=="function"&&Ot instanceof Ot&&typeof Tt=="function"&&Tt instanceof Tt)&&(k=!1)}return o.delete(e),o.delete(t),k}function Fr(e){return sr(e,xe,an)}function Lr(){var e=x.iteratee||Dt;return e=e===Dt?jt:e,arguments.length?e(arguments[0],arguments[1]):e}function gt(e,t){var n=e.__data__;return Hr(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Br(e){for(var t=xe(e),n=t.length;n--;){var r=t[n],s=e[r];t[n]=[r,s,un(s)]}return t}function Ye(e,t){var n=ft(e,t);return pr(n)?n:_}var an=Jt?be(Jt,Object):vn,he=fr;(xt&&he(new xt(new ArrayBuffer(1)))!=f||tt&&he(new tt)!=M||Pt&&he(Pt.resolve())!=le||Nt&&he(new Nt)!=G||Mt&&he(new Mt)!=d)&&(he=function(e){var t=Re.call(e),n=t==J?e.constructor:_,r=n?Ge(n):_;if(r)switch(r){case Mn:return f;case In:return M;case Rn:return le;case Cn:return G;case Gn:return d}return t});function Dr(e,t,n){t=yt(t,e)?[t]:nn(t);for(var r,s=-1,p=t.length;++s<p;){var o=mt(t[s]);if(!(r=e!=null&&n(e,o)))break;e=e[o]}if(r)return r;var p=e?e.length:0;return!!p&&bt(p)&&Ft(o,p)&&(ie(e)||Qe(e))}function Wr(e){var t=e.length,n=e.constructor(t);return t&&typeof e[0]=="string"&&V.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function qr(e){return typeof e.constructor=="function"&&!ht(e)?ir(Kt(e)):{}}function $r(e,t,n,r){var s=e.constructor;switch(t){case S:return Ct(e);case fe:case ye:return new s(+e);case f:return Or(e,r);case c:case h:case a:case w:case N:case I:case F:case ue:case W:return Pr(e,r);case M:return Tr(e,r,n);case A:case T:return new s(e);case i:return Er(e);case G:return Sr(e,r,n);case P:return xr(e)}}function Ft(e,t){return t=t??Z,!!t&&(typeof e=="number"||oe.test(e))&&e>-1&&e%1==0&&e<t}function Ur(e,t,n){if(!ge(n))return!1;var r=typeof t;return(r=="number"?Fe(n)&&Ft(t,n.length):r=="string"&&t in n)?Ze(n[t],e):!1}function yt(e,t){if(ie(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||At(e)?!0:Be.test(e)||!ot.test(e)||t!=null&&e in Object(t)}function Hr(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Kr(e){return!!Ke&&Ke in e}function ht(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Se;return e===n}function un(e){return e===e&&!ge(e)}function sn(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==_||e in Object(n))}}function Xr(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var Jr=vt(function(e){e=dn(e);var t=[];return Ve.test(e)&&t.push(""),e.replace(ke,function(n,r,s,o){t.push(s?o.replace(Ne,"$1"):r||n)}),t});function mt(e){if(typeof e=="string"||At(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function Ge(e){if(e!=null){try{return Xe.call(e)}catch{}try{return e+""}catch{}}return""}function Yr(e){for(var t=-1,n=e?e.length:0,r=0,s=[];++t<n;){var o=e[t];o&&(s[r++]=o)}return s}function fn(e,t){var n=ie(e)?qe:or;return n(e,Lr(t,3))}function vt(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(D);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],o=n.cache;if(o.has(s))return o.get(s);var p=e.apply(this,r);return n.cache=o.set(s,p),p};return n.cache=new(vt.Cache||we),n}vt.Cache=we;function Zr(e){return Je(e,!1,!0)}function Ze(e,t){return e===t||e!==e&&t!==t}function Qe(e){return Lt(e)&&V.call(e,"callee")&&(!Xt.call(e,"callee")||Re.call(e)==j)}var ie=Array.isArray;function Fe(e){return e!=null&&bt(e.length)&&!_t(e)}function Lt(e){return ze(e)&&Fe(e)}var Bt=Pn||_n;function Qr(e){if(Fe(e)&&(ie(e)||typeof e=="string"||typeof e.splice=="function"||Bt(e)||Qe(e)))return!e.length;var t=he(e);if(t==M||t==G)return!e.size;if(Nn||ht(e))return!Yt(e).length;for(var n in e)if(V.call(e,n))return!1;return!0}function _t(e){var t=ge(e)?Re.call(e):"";return t==l||t==u}function bt(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Z}function ge(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function ze(e){return!!e&&typeof e=="object"}function ln(e){if(!ze(e)||Re.call(e)!=J||se(e))return!1;var t=Kt(e);if(t===null)return!0;var n=V.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Xe.call(n)==St}function At(e){return typeof e=="symbol"||ze(e)&&Re.call(e)==P}var wt=at?Me(at):gr;function cn(e){return Gt(e,yn(e))}function dn(e){return e==null?"":Ar(e)}function pn(e,t,n){var r=e==null?_:kt(e,t);return r===_?n:r}function gn(e,t){return e!=null&&Dr(e,t,lr)}function xe(e){return Fe(e)?zt(e):yr(e)}function yn(e){return Fe(e)?zt(e,!0):en(e)}var zr=Mr(function(e,t,n){tn(e,t,n)});function hn(e){return e}function Dt(e){return jt(typeof e=="function"?e:Je(e,!0))}function mn(e){return yt(e)?_e(mt(e)):_r(e)}function vn(){return[]}function _n(){return!1}x.compact=Yr,x.iteratee=Dt,x.keys=xe,x.keysIn=yn,x.memoize=vt,x.merge=zr,x.property=mn,x.toPlainObject=cn,x.clone=Zr,x.eq=Ze,x.forEach=fn,x.get=pn,x.hasIn=gn,x.identity=hn,x.isArguments=Qe,x.isArray=ie,x.isArrayLike=Fe,x.isArrayLikeObject=Lt,x.isBuffer=Bt,x.isEmpty=Qr,x.isFunction=_t,x.isLength=bt,x.isObject=ge,x.isObjectLike=ze,x.isPlainObject=ln,x.isSymbol=At,x.isTypedArray=wt,x.stubArray=vn,x.stubFalse=_n,x.toString=dn,x.each=fn,x.VERSION=R,U&&((U.exports=x)._=x,ee._=x)}).call(Vr)}(it,it.exports)),it.exports}var Wt,wn;function jr(){if(wn)return Wt;wn=1,Wt=v;function v(R,Y){var D=R&&R.type,O;if(D==="FeatureCollection")for(O=0;O<R.features.length;O++)v(R.features[O],Y);else if(D==="GeometryCollection")for(O=0;O<R.geometries.length;O++)v(R.geometries[O],Y);else if(D==="Feature")v(R.geometry,Y);else if(D==="Polygon")ae(R.coordinates,Y);else if(D==="MultiPolygon")for(O=0;O<R.coordinates.length;O++)ae(R.coordinates[O],Y);return R}function ae(R,Y){if(R.length!==0){_(R[0],Y);for(var D=1;D<R.length;D++)_(R[D],!Y)}}function _(R,Y){for(var D=0,O=0,g=0,L=R.length,Z=L-1;g<L;Z=g++){var j=(R[g][0]-R[Z][0])*(R[Z][1]+R[g][1]),X=D+j;O+=Math.abs(D)>=Math.abs(j)?D-X+j:j-X+D,D=X}D+O>=0!=!!Y&&R.reverse()}return Wt}const ei=[{key:"building",polygon:"all"},{key:"highway",polygon:"whitelist",values:["services","rest_area","escape","elevator"]},{key:"natural",polygon:"blacklist",values:["coastline","cliff","ridge","arete","tree_row"]},{key:"landuse",polygon:"all"},{key:"waterway",polygon:"whitelist",values:["riverbank","dock","boatyard","dam"]},{key:"amenity",polygon:"all"},{key:"leisure",polygon:"all"},{key:"barrier",polygon:"whitelist",values:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},{key:"railway",polygon:"whitelist",values:["station","turntable","roundhouse","platform"]},{key:"area",polygon:"all"},{key:"boundary",polygon:"all"},{key:"man_made",polygon:"blacklist",values:["cutline","embankment","pipeline"]},{key:"power",polygon:"whitelist",values:["plant","substation","generator","transformer"]},{key:"place",polygon:"all"},{key:"shop",polygon:"all"},{key:"aeroway",polygon:"blacklist",values:["taxiway"]},{key:"tourism",polygon:"all"},{key:"historic",polygon:"all"},{key:"public_transport",polygon:"all"},{key:"office",polygon:"all"},{key:"building:part",polygon:"all"},{key:"military",polygon:"all"},{key:"ruins",polygon:"all"},{key:"area:highway",polygon:"all"},{key:"craft",polygon:"all"},{key:"golf",polygon:"all"},{key:"indoor",polygon:"all"}];var qt,On;function ti(){return On||(On=1,qt=ei),qt}var $t,Tn;function ni(){if(Tn)return $t;Tn=1;var v=kr(),ae=jr(),_={};ti().forEach(function(O){if(O.polygon==="all")_[O.key]=!0;else{var g=O.polygon==="whitelist"?"included_values":"excluded_values",L={};O.values.forEach(function(Z){L[Z]=!0}),_[O.key]={},_[O.key][g]=L}});function R(O,g){return(O.version||g.version)&&O.version!==g.version?(+O.version||0)>(+g.version||0)?O:g:v.merge(O,g)}var Y={};Y=function(O,g,L){g=v.merge({verbose:!1,flatProperties:!0,uninterestingTags:{source:!0,source_ref:!0,"source:ref":!0,history:!0,attribution:!0,created_by:!0,"tiger:county":!0,"tiger:tlid":!0,"tiger:upload_uuid":!0},polygonFeatures:_,deduplicator:R},g);var Z;return typeof XMLDocument<"u"&&O instanceof XMLDocument||typeof XMLDocument>"u"&&O.childNodes?Z=X(O):Z=j(O),Z;function j(B){var l=new Array,u=new Array,M=new Array;function A(f){var c=v.clone(f);c.lat=f.center.lat,c.lon=f.center.lon,c.__is_center_placeholder=!0,l.push(c)}function J(f){var c=v.clone(f);c.nodes=[];function h(a,w,N){var I={type:"node",id:"_"+c.type+"/"+c.id+"bounds"+N,lat:a,lon:w};c.nodes.push(I.id),l.push(I)}h(c.bounds.minlat,c.bounds.minlon,1),h(c.bounds.maxlat,c.bounds.minlon,2),h(c.bounds.maxlat,c.bounds.maxlon,3),h(c.bounds.minlat,c.bounds.maxlon,4),c.nodes.push(c.nodes[0]),c.__is_bounds_placeholder=!0,u.push(c)}function le(f){function c(h,a,w){var N={type:"node",id:w,lat:h,lon:a};l.push(N)}v.isArray(f.nodes)||(f.nodes=f.geometry.map(function(h){return h!==null?"_anonymous@"+h.lat+"/"+h.lon:"_anonymous@unknown_location"})),f.geometry.forEach(function(h,a){h&&c(h.lat,h.lon,f.nodes[a])})}function i(f){function c(a,w,N){var I={type:"node",id:N,lat:a,lon:w};l.push(I)}function h(a,w){if(u.some(function(F){return F.type=="way"&&F.id==w}))return;var N={type:"way",id:w,nodes:[]};function I(F,ue){var W={type:"node",id:"_anonymous@"+F+"/"+ue,lat:F,lon:ue};N.nodes.push(W.id),l.push(W)}a.forEach(function(F){F?I(F.lat,F.lon):N.nodes.push(void 0)}),u.push(N)}f.members.forEach(function(a,w){a.type=="node"?a.lat&&c(a.lat,a.lon,a.ref):a.type=="way"&&a.geometry&&(a.ref="_fullGeom"+a.ref,h(a.geometry,a.ref))})}for(var G=0;G<B.elements.length;G++)switch(B.elements[G].type){case"node":var T=B.elements[G];l.push(T);break;case"way":var P=v.clone(B.elements[G]);P.nodes=v.clone(P.nodes),u.push(P),P.center&&A(P),P.geometry?le(P):P.bounds&&J(P);break;case"relation":var d=v.clone(B.elements[G]);d.members=v.clone(d.members),M.push(d);var S=d.members&&d.members.some(function(f){return f.type=="node"&&f.lat||f.type=="way"&&f.geometry&&f.geometry.length>0});d.center&&A(d),S?i(d):d.bounds&&J(d);break}return fe(l,u,M)}function X(B){var l=new Array,u=new Array,M=new Array;function A(d,S,f){d.hasAttribute(f)&&(S[f]=d.getAttribute(f))}function J(d,S){var f=v.clone(d);A(S,f,"lat"),A(S,f,"lon"),f.__is_center_placeholder=!0,l.push(f)}function le(d,S){var f=v.clone(d);f.nodes=[];function c(h,a,w){var N={type:"node",id:"_"+f.type+"/"+f.id+"bounds"+w,lat:h,lon:a};f.nodes.push(N.id),l.push(N)}c(S.getAttribute("minlat"),S.getAttribute("minlon"),1),c(S.getAttribute("maxlat"),S.getAttribute("minlon"),2),c(S.getAttribute("maxlat"),S.getAttribute("maxlon"),3),c(S.getAttribute("minlat"),S.getAttribute("maxlon"),4),f.nodes.push(f.nodes[0]),f.__is_bounds_placeholder=!0,u.push(f)}function i(d,S){function f(c,h,a){var w={type:"node",id:a,lat:c,lon:h};return l.push(w),w.id}v.isArray(d.nodes)||(d.nodes=[],v.each(S,function(c,h){d.nodes.push("_anonymous@"+c.getAttribute("lat")+"/"+c.getAttribute("lon"))})),v.each(S,function(c,h){c.getAttribute("lat")&&f(c.getAttribute("lat"),c.getAttribute("lon"),d.nodes[h])})}function G(d,S){function f(h,a,w){var N={type:"node",id:w,lat:h,lon:a};l.push(N)}function c(h,a){if(u.some(function(I){return I.type=="way"&&I.id==a}))return;var w={type:"way",id:a,nodes:[]};function N(I,F){var ue={type:"node",id:"_anonymous@"+I+"/"+F,lat:I,lon:F};w.nodes.push(ue.id),l.push(ue)}v.each(h,function(I){I.getAttribute("lat")?N(I.getAttribute("lat"),I.getAttribute("lon")):w.nodes.push(void 0)}),u.push(w)}v.each(S,function(h,a){d.members[a].type=="node"?h.getAttribute("lat")&&f(h.getAttribute("lat"),h.getAttribute("lon"),d.members[a].ref):d.members[a].type=="way"&&h.getElementsByTagName("nd").length>0&&(d.members[a].ref="_fullGeom"+d.members[a].ref,c(h.getElementsByTagName("nd"),d.members[a].ref))})}v.each(B.getElementsByTagName("node"),function(d,S){var f={};v.each(d.getElementsByTagName("tag"),function(h){f[h.getAttribute("k")]=h.getAttribute("v")});var c={type:"node"};A(d,c,"id"),A(d,c,"lat"),A(d,c,"lon"),A(d,c,"version"),A(d,c,"timestamp"),A(d,c,"changeset"),A(d,c,"uid"),A(d,c,"user"),v.isEmpty(f)||(c.tags=f),l.push(c)});var T,P;return v.each(B.getElementsByTagName("way"),function(d,S){var f={},c=[];v.each(d.getElementsByTagName("tag"),function(w){f[w.getAttribute("k")]=w.getAttribute("v")});var h=!1;v.each(d.getElementsByTagName("nd"),function(w,N){var I;(I=w.getAttribute("ref"))&&(c[N]=I),!h&&w.getAttribute("lat")&&(h=!0)});var a={type:"way"};A(d,a,"id"),A(d,a,"version"),A(d,a,"timestamp"),A(d,a,"changeset"),A(d,a,"uid"),A(d,a,"user"),c.length>0&&(a.nodes=c),v.isEmpty(f)||(a.tags=f),(T=d.getElementsByTagName("center")[0])&&J(a,T),h?i(a,d.getElementsByTagName("nd")):(P=d.getElementsByTagName("bounds")[0])&&le(a,P),u.push(a)}),v.each(B.getElementsByTagName("relation"),function(d,S){var f={},c=[];v.each(d.getElementsByTagName("tag"),function(w){f[w.getAttribute("k")]=w.getAttribute("v")});var h=!1;v.each(d.getElementsByTagName("member"),function(w,N){c[N]={},A(w,c[N],"ref"),A(w,c[N],"role"),A(w,c[N],"type"),(!h&&c[N].type=="node"&&w.getAttribute("lat")||c[N].type=="way"&&w.getElementsByTagName("nd").length>0)&&(h=!0)});var a={type:"relation"};A(d,a,"id"),A(d,a,"version"),A(d,a,"timestamp"),A(d,a,"changeset"),A(d,a,"uid"),A(d,a,"user"),c.length>0&&(a.members=c),v.isEmpty(f)||(a.tags=f),(T=d.getElementsByTagName("center")[0])&&J(a,T),h?G(a,d.getElementsByTagName("member")):(P=d.getElementsByTagName("bounds")[0])&&le(a,P),M.push(a)}),fe(l,u,M)}function fe(B,l,u){function M(z,oe){if(typeof oe!="object"&&(oe={}),typeof g.uninterestingTags=="function")return!g.uninterestingTags(z,oe);for(var y in z)if(g.uninterestingTags[y]!==!0&&!(oe[y]===!0||oe[y]===z[y]))return!0;return!1}function A(z){var oe={timestamp:z.timestamp,version:z.version,changeset:z.changeset,user:z.user,uid:z.uid};for(var y in oe)oe[y]===void 0&&delete oe[y];return oe}for(var J=new Object,le=new Object,i=0;i<B.length;i++){var G=B[i];J[G.id]!==void 0&&(G=g.deduplicator(G,J[G.id])),J[G.id]=G,typeof G.tags<"u"&&M(G.tags)&&(le[G.id]=!0)}for(var i=0;i<u.length;i++)if(v.isArray(u[i].members))for(var T=0;T<u[i].members.length;T++)u[i].members[T].type=="node"&&(le[u[i].members[T].ref]=!0);for(var P=new Object,d=new Object,i=0;i<l.length;i++){var S=l[i];if(P[S.id]&&(S=g.deduplicator(S,P[S.id])),P[S.id]=S,v.isArray(S.nodes))for(var T=0;T<S.nodes.length;T++)typeof S.nodes[T]!="object"&&(d[S.nodes[T]]=!0,S.nodes[T]=J[S.nodes[T]])}var f=new Array;for(var c in J){var G=J[c];(!d[c]||le[c])&&f.push(G)}for(var h=new Array,i=0;i<u.length;i++){var a=u[i];h[a.id]&&(a=g.deduplicator(a,h[a.id])),h[a.id]=a}var w={node:{},way:{},relation:{}};for(var c in h){var a=h[c];if(!v.isArray(a.members)){g.verbose&&console.warn("Relation",a.type+"/"+a.id,"ignored because it has no members");continue}for(var T=0;T<a.members.length;T++){var N=a.members[T].type,I=a.members[T].ref;if(typeof I!="number"&&(I=I.replace("_fullGeom","")),!w[N]){g.verbose&&console.warn("Relation",a.type+"/"+a.id,"member",N+"/"+I,"ignored because it has an invalid type");continue}typeof w[N][I]>"u"&&(w[N][I]=[]),w[N][I].push({role:a.members[T].role,rel:a.id,reltags:a.tags})}}var F,ue=[];for(i=0;i<f.length;i++){if(typeof f[i].lon>"u"||typeof f[i].lat>"u"){g.verbose&&console.warn("POI",f[i].type+"/"+f[i].id,"ignored because it lacks coordinates");continue}var W={type:"Feature",id:f[i].type+"/"+f[i].id,properties:{type:f[i].type,id:f[i].id,tags:f[i].tags||{},relations:w.node[f[i].id]||[],meta:A(f[i])},geometry:{type:"Point",coordinates:[+f[i].lon,+f[i].lat]}};f[i].__is_center_placeholder&&(W.properties.geometry="center"),L?L(W):ue.push(W)}for(var ot=[],Be=[],i=0;i<u.length;i++)if(h[u[i].id]===u[i]){if(typeof u[i].tags<"u"&&(u[i].tags.type=="route"||u[i].tags.type=="waterway")){let oe=function(y){var b=!1,ce;ce=y.members.filter(function(U){return U.type==="way"}),ce=ce.map(function(U){var re=P[U.ref];if(re===void 0||re.nodes===void 0){g.verbose&&console.warn("Route "+y.type+"/"+y.id,"tainted by a missing or incomplete  way",U.type+"/"+U.ref),b=!0;return}return{id:U.ref,role:U.role,way:re,nodes:re.nodes.filter(function(ve){return ve!==void 0?!0:(b=!0,g.verbose&&console.warn("Route",y.type+"/"+y.id,"tainted by a way",U.type+"/"+U.ref,"with a missing node"),!1)})}}),ce=v.compact(ce);var Te;Te=D(ce);var $=[];if($=v.compact(Te.map(function(U){return v.compact(U.map(function(re){return[+re.lon,+re.lat]}))})),$.length==0)return g.verbose&&console.warn("Route",y.type+"/"+y.id,"contains no coordinates"),!1;var ee={type:"Feature",id:y.type+"/"+y.id,properties:{type:y.type,id:y.id,tags:y.tags||{},relations:w[y.type][y.id]||[],meta:A(y)},geometry:{type:$.length===1?"LineString":"MultiLineString",coordinates:$.length===1?$[0]:$}};return b&&(g.verbose&&console.warn("Route",y.type+"/"+y.id,"is tainted"),ee.properties.tainted=!0),ee};if(!v.isArray(u[i].members)){g.verbose&&console.warn("Route",u[i].type+"/"+u[i].id,"ignored because it has no members");continue}if(u[i].members.forEach(function(y){P[y.ref]&&!M(P[y.ref].tags)&&(P[y.ref].is_skippablerelationmember=!0)}),W=oe(u[i]),W===!1){g.verbose&&console.warn("Route relation",u[i].type+"/"+u[i].id,"ignored because it has invalid geometry");continue}L?L(ae(W)):Be.push(W)}if(typeof u[i].tags<"u"&&(u[i].tags.type=="multipolygon"||u[i].tags.type=="boundary")){let y=function(b,ce){var Te=!1,$=ke?"way":"relation",ee=typeof b.id=="number"?b.id:+b.id.replace("_fullGeom",""),U;U=ce.members.filter(function(H){return H.type==="way"}),U=U.map(function(H){var de=P[H.ref];if(de===void 0||de.nodes===void 0){g.verbose&&console.warn("Multipolygon",$+"/"+ee,"tainted by a missing or incomplete way",H.type+"/"+H.ref),Te=!0;return}return{id:H.ref,role:H.role||"outer",way:de,nodes:de.nodes.filter(function(_e){return _e!==void 0?!0:(Te=!0,g.verbose&&console.warn("Multipolygon",$+"/"+ee,"tainted by a way",H.type+"/"+H.ref,"with a missing node"),!1)})}}),U=v.compact(U);var re,ve;re=D(U.filter(function(H){return H.role==="outer"})),ve=D(U.filter(function(H){return H.role==="inner"}));var De;function at(H){var de=function(se,te){for(var be=0;be<te.length;be++)if($e(te[be],se))return!0;return!1},_e=function(se){return se.map(function(te){return[+te.lat,+te.lon]})},$e=function(se,te){for(var be=se[0],Ie=se[1],et=!1,Ue=0,Se=te.length-1;Ue<te.length;Se=Ue++){var He=te[Ue][0],Ke=te[Ue][1],Xe=te[Se][0],V=te[Se][1],St=Ke>Ie!=V>Ie&&be<(Xe-He)*(Ie-Ke)/(V-Ke)+He;St&&(et=!et)}return et},Me,ft;for(H=_e(H),Me=0;Me<re.length;Me++)if(ft=_e(re[Me]),de(ft,H))return Me}De=re.map(function(H){return[H]});for(var We=0;We<ve.length;We++){var ut=at(ve[We]);ut!==void 0?De[ut].push(ve[We]):g.verbose&&console.warn("Multipolygon",$+"/"+ee,"contains an inner ring with no containing outer")}var Ee=[];if(Ee=v.compact(De.map(function(H){var de=v.compact(H.map(function(_e){if(_e.length<4){g.verbose&&console.warn("Multipolygon",$+"/"+ee,"contains a ring with less than four nodes");return}return v.compact(_e.map(function($e){return[+$e.lon,+$e.lat]}))}));if(de.length==0){g.verbose&&console.warn("Multipolygon",$+"/"+ee,"contains an empty ring cluster");return}return de})),Ee.length==0)return g.verbose&&console.warn("Multipolygon",$+"/"+ee,"contains no coordinates"),!1;var qe="MultiPolygon";Ee.length===1&&(qe="Polygon",Ee=Ee[0]);var st={type:"Feature",id:b.type+"/"+ee,properties:{type:b.type,id:ee,tags:b.tags||{},relations:w[b.type][b.id]||[],meta:A(b)},geometry:{type:qe,coordinates:Ee}};return Te&&(g.verbose&&console.warn("Multipolygon",$+"/"+ee,"is tainted"),st.properties.tainted=!0),st};if(!v.isArray(u[i].members)){g.verbose&&console.warn("Multipolygon",u[i].type+"/"+u[i].id,"ignored because it has no members");continue}for(var Ve=0,T=0;T<u[i].members.length;T++)u[i].members[T].role=="outer"?Ve++:g.verbose&&u[i].members[T].role!="inner"&&console.warn("Multipolygon",u[i].type+"/"+u[i].id,"member",u[i].members[T].type+"/"+u[i].members[T].ref,'ignored because it has an invalid role: "'+u[i].members[T].role+'"');if(u[i].members.forEach(function(b){P[b.ref]&&(b.role==="outer"&&!M(P[b.ref].tags,u[i].tags)&&(P[b.ref].is_skippablerelationmember=!0),b.role==="inner"&&!M(P[b.ref].tags)&&(P[b.ref].is_skippablerelationmember=!0))}),Ve==0){g.verbose&&console.warn("Multipolygon relation",u[i].type+"/"+u[i].id,"ignored because it has no outer ways");continue}var ke=!1;Ve==1&&!M(u[i].tags,{type:!0})&&(ke=!0);var W=null;if(!ke)W=y(u[i],u[i]);else{var me=u[i].members.filter(function(b){return b.role==="outer"})[0];if(me=P[me.ref],me===void 0){g.verbose&&console.warn("Multipolygon relation",u[i].type+"/"+u[i].id,"ignored because outer way",me.type+"/"+me.ref,"is missing");continue}me.is_skippablerelationmember=!0,W=y(me,u[i])}if(W===!1){g.verbose&&console.warn("Multipolygon relation",u[i].type+"/"+u[i].id,"ignored because it has invalid geometry");continue}L?L(ae(W)):Be.push(W)}}for(var i=0;i<l.length;i++)if(P[l[i].id]===l[i]){if(!v.isArray(l[i].nodes)){g.verbose&&console.warn("Way",l[i].type+"/"+l[i].id,"ignored because it has no nodes");continue}if(!l[i].is_skippablerelationmember){typeof l[i].id!="number"&&(l[i].id=+l[i].id.replace("_fullGeom","")),l[i].tainted=!1,l[i].hidden=!1;var Ne=new Array;for(T=0;T<l[i].nodes.length;T++)typeof l[i].nodes[T]=="object"?Ne.push([+l[i].nodes[T].lon,+l[i].nodes[T].lat]):(g.verbose&&console.warn("Way",l[i].type+"/"+l[i].id,"is tainted by an invalid node"),l[i].tainted=!0);if(Ne.length<=1){g.verbose&&console.warn("Way",l[i].type+"/"+l[i].id,"ignored because it contains too few nodes");continue}var je="LineString";typeof l[i].nodes[0]<"u"&&typeof l[i].nodes[l[i].nodes.length-1]<"u"&&l[i].nodes[0].id===l[i].nodes[l[i].nodes.length-1].id&&(typeof l[i].tags<"u"&&ye(l[i].tags)||l[i].__is_bounds_placeholder)&&(je="Polygon",Ne=[Ne]);var W={type:"Feature",id:l[i].type+"/"+l[i].id,properties:{type:l[i].type,id:l[i].id,tags:l[i].tags||{},relations:w.way[l[i].id]||[],meta:A(l[i])},geometry:{type:je,coordinates:Ne}};l[i].tainted&&(g.verbose&&console.warn("Way",l[i].type+"/"+l[i].id,"is tainted"),W.properties.tainted=!0),l[i].__is_bounds_placeholder&&(W.properties.geometry="bounds"),L?L(ae(W)):je=="LineString"?ot.push(W):Be.push(W)}}return L?!0:(F={type:"FeatureCollection",features:[]},F.features=F.features.concat(Be),F.features=F.features.concat(ot),F.features=F.features.concat(ue),g.flatProperties&&F.features.forEach(function(z){z.properties=v.merge(z.properties.meta,z.properties.tags,{id:z.properties.type+"/"+z.properties.id})}),F=ae(F),F)}function ye(B){var l=g.polygonFeatures;if(typeof l=="function")return l(B);if(B.area==="no")return!1;for(var u in B){var M=B[u],A=l[u];if(!(typeof A>"u")&&M!=="no"&&(A===!0||A.included_values&&A.included_values[M]===!0||A.excluded_values&&A.excluded_values[M]!==!0))return!0}return!1}};function D(O){for(var g=function(M){return M[0]},L=function(M){return M[M.length-1]},Z=function(M,A){return M!==void 0&&A!==void 0&&M.id===A.id},j=[],X,fe,ye,B,l,u;O.length;)for(X=O.pop().nodes.slice(),j.push(X);O.length&&!Z(g(X),L(X));){for(fe=g(X),ye=L(X),B=0;B<O.length;B++)if(u=O[B].nodes,Z(ye,g(u))){l=X.push,u=u.slice(1);break}else if(Z(ye,L(u))){l=X.push,u=u.slice(0,-1).reverse();break}else if(Z(fe,L(u))){l=X.unshift,u=u.slice(0,-1);break}else if(Z(fe,g(u))){l=X.unshift,u=u.slice(1).reverse();break}else u=l=null;if(!u)break;O.splice(B,1),l.apply(X,u)}return j}return Y.toGeojson=Y,$t=Y,$t}var ri=ni();const oi=({commandRegistry:v,workspaceService:ae})=>{v.registerAll({command:{id:"overpass",name:"OpenStreetMap Overpass",description:"Runs a query against the OpenStreetMap Overpass API to download geodata",llm:{prompt:"use boundary=administrative; use [out:json]; use nwr to select all nodes, ways and relations; use out geom to include geometries"},parameters:[{name:"query",description:"the overpass query to submit, use {{varX}} to reference a variable from a previously executed command, for example {{viewExtent}} to obtain the current view's extents as a bounding box",required:!0},{name:"outputFile",description:"the path to the output file within the workspace",required:!0}]},handler:{execute:async({params:{query:_,outputFile:R}})=>{if(!_||!R)return;const Y=await fetch("https://overpass-api.de/api/interpreter",{method:"POST",body:_}).then(g=>g.json()).then(ri.toGeojson),D=await ae.getWorkspace(),O=await(D==null?void 0:D.getResource(R,{create:!0}));O&&await O.saveContents(JSON.stringify(Y))}}})};export{oi as default};
