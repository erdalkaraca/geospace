var De=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var tt=De((rt,z)=>{const Le="0.29.0";var xe={version:Le},Te=Object.defineProperty,a=(e,t)=>Te(e,"name",{value:t,configurable:!0}),K=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')}),Ce=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return n=>{for(var i=n.length,r=new Uint8Array((i-(n[i-1]=="=")-(n[i-2]=="="))*3/4|0),o=0,s=0;o<i;){var l=e[n.charCodeAt(o++)],c=e[n.charCodeAt(o++)],u=e[n.charCodeAt(o++)],d=e[n.charCodeAt(o++)];r[s++]=l<<2|c>>4,r[s++]=c<<4|u>>2,r[s++]=u<<6|d}return r}})();function Y(e){return!isNaN(parseFloat(e))&&isFinite(e)}a(Y,"_isNumber");function b(e){return e.charAt(0).toUpperCase()+e.substring(1)}a(b,"_capitalize");function C(e){return function(){return this[e]}}a(C,"_getter");var I=["isConstructor","isEval","isNative","isToplevel"],O=["columnNumber","lineNumber"],_=["fileName","functionName","source"],Me=["args"],Ue=["evalOrigin"],T=I.concat(O,_,Me,Ue);function m(e){if(e)for(var t=0;t<T.length;t++)e[T[t]]!==void 0&&this["set"+b(T[t])](e[T[t]])}a(m,"StackFrame");m.prototype={getArgs:a(function(){return this.args},"getArgs"),setArgs:a(function(e){if(Object.prototype.toString.call(e)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=e},"setArgs"),getEvalOrigin:a(function(){return this.evalOrigin},"getEvalOrigin"),setEvalOrigin:a(function(e){if(e instanceof m)this.evalOrigin=e;else if(e instanceof Object)this.evalOrigin=new m(e);else throw new TypeError("Eval Origin must be an Object or StackFrame")},"setEvalOrigin"),toString:a(function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",n=this.getColumnNumber()||"",i=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+n+")":"[eval]:"+t+":"+n:i?i+" ("+e+":"+t+":"+n+")":e+":"+t+":"+n},"toString")};m.fromString=a(function(e){var t=e.indexOf("("),n=e.lastIndexOf(")"),i=e.substring(0,t),r=e.substring(t+1,n).split(","),o=e.substring(n+1);if(o.indexOf("@")===0)var s=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(o,""),l=s[1],c=s[2],u=s[3];return new m({functionName:i,args:r||void 0,fileName:l,lineNumber:c||void 0,columnNumber:u||void 0})},"StackFrame$$fromString");for(S=0;S<I.length;S++)m.prototype["get"+b(I[S])]=C(I[S]),m.prototype["set"+b(I[S])]=(function(e){return function(t){this[e]=!!t}})(I[S]);var S;for(N=0;N<O.length;N++)m.prototype["get"+b(O[N])]=C(O[N]),m.prototype["set"+b(O[N])]=(function(e){return function(t){if(!Y(t))throw new TypeError(e+" must be a Number");this[e]=Number(t)}})(O[N]);var N;for(k=0;k<_.length;k++)m.prototype["get"+b(_[k])]=C(_[k]),m.prototype["set"+b(_[k])]=(function(e){return function(t){this[e]=String(t)}})(_[k]);var k,U=m;function Z(){var e=/^\s*at .*(\S+:\d+|\(native\))/m,t=/^(eval@)?(\[native code])?$/;return{parse:a(function(n){if(n.stack&&n.stack.match(e))return this.parseV8OrIE(n);if(n.stack)return this.parseFFOrSafari(n);throw new Error("Cannot parse given Error object")},"ErrorStackParser$$parse"),extractLocation:a(function(n){if(n.indexOf(":")===-1)return[n];var i=/(.+?)(?::(\d+))?(?::(\d+))?$/,r=i.exec(n.replace(/[()]/g,""));return[r[1],r[2]||void 0,r[3]||void 0]},"ErrorStackParser$$extractLocation"),parseV8OrIE:a(function(n){var i=n.stack.split(`
`).filter(function(r){return!!r.match(e)},this);return i.map(function(r){r.indexOf("(eval ")>-1&&(r=r.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var o=r.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),s=o.match(/ (\(.+\)$)/);o=s?o.replace(s[0],""):o;var l=this.extractLocation(s?s[1]:o),c=s&&o||void 0,u=["eval","<anonymous>"].indexOf(l[0])>-1?void 0:l[0];return new U({functionName:c,fileName:u,lineNumber:l[1],columnNumber:l[2],source:r})},this)},"ErrorStackParser$$parseV8OrIE"),parseFFOrSafari:a(function(n){var i=n.stack.split(`
`).filter(function(r){return!r.match(t)},this);return i.map(function(r){if(r.indexOf(" > eval")>-1&&(r=r.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),r.indexOf("@")===-1&&r.indexOf(":")===-1)return new U({functionName:r});var o=/((.*".+"[^@]*)?[^@]*)(?:@)/,s=r.match(o),l=s&&s[1]?s[1]:void 0,c=this.extractLocation(r.replace(o,""));return new U({functionName:l,fileName:c[0],lineNumber:c[1],columnNumber:c[2],source:r})},this)},"ErrorStackParser$$parseFFOrSafari")}}a(Z,"ErrorStackParser");var Be=new Z,We=Be;function Q(){if(typeof API<"u"&&API!==globalThis.API)return API.runtimeEnv;let e=typeof Bun<"u",t=typeof Deno<"u",n=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&!process.browser,i=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Chrome")===-1&&navigator.userAgent.indexOf("Safari")>-1;return X({IN_BUN:e,IN_DENO:t,IN_NODE:n,IN_SAFARI:i,IN_SHELL:typeof read=="function"&&typeof load=="function"})}a(Q,"getGlobalRuntimeEnv");var p=Q();function X(e){let t=e.IN_NODE&&typeof z<"u"&&z.exports&&typeof K=="function"&&typeof __dirname=="string",n=e.IN_NODE&&!t,i=!e.IN_NODE&&!e.IN_DENO&&!e.IN_BUN,r=i&&typeof window<"u"&&typeof window.document<"u"&&typeof document.createElement=="function"&&"sessionStorage"in window&&typeof globalThis.importScripts!="function",o=i&&typeof globalThis.WorkerGlobalScope<"u"&&typeof globalThis.self<"u"&&globalThis.self instanceof globalThis.WorkerGlobalScope;return{...e,IN_BROWSER:i,IN_BROWSER_MAIN_THREAD:r,IN_BROWSER_WEB_WORKER:o,IN_NODE_COMMONJS:t,IN_NODE_ESM:n}}a(X,"calculateDerivedFlags");var ee,B,te,G,H;async function V(){if(!p.IN_NODE||(ee=(await import("./__vite-browser-external-9wXp6ZBx.js")).default,G=await import("./__vite-browser-external-9wXp6ZBx.js"),H=await import("./__vite-browser-external-9wXp6ZBx.js"),te=(await import("./__vite-browser-external-9wXp6ZBx.js")).default,B=await import("./__vite-browser-external-9wXp6ZBx.js"),q=B.sep,typeof K<"u"))return;let e=G,t=await import("./__vite-browser-external-9wXp6ZBx.js"),n=await import("./__vite-browser-external-9wXp6ZBx.js"),i=await import("./__vite-browser-external-9wXp6ZBx.js"),r={fs:e,crypto:t,ws:n,child_process:i};globalThis.require=function(o){return r[o]}}a(V,"initNodeModules");function ne(e,t){return B.resolve(t||".",e)}a(ne,"node_resolvePath");function re(e,t){return t===void 0&&(t=location),new URL(e,t).toString()}a(re,"browser_resolvePath");var R;p.IN_NODE?R=ne:p.IN_SHELL?R=a(e=>e,"resolvePath"):R=re;var q;p.IN_NODE||(q="/");function ie(e,t){return e.startsWith("file://")&&(e=e.slice(7)),e.includes("://")?{response:fetch(e)}:{binary:H.readFile(e).then(n=>new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}}a(ie,"node_getBinaryResponse");function oe(e,t){if(e.startsWith("file://")&&(e=e.slice(7)),e.includes("://"))throw new Error("Shell cannot fetch urls");return{binary:Promise.resolve(new Uint8Array(readbuffer(e)))}}a(oe,"shell_getBinaryResponse");function ae(e,t){let n=new URL(e,location);return{response:fetch(n,t?{integrity:t}:{})}}a(ae,"browser_getBinaryResponse");var D;p.IN_NODE?D=ie:p.IN_SHELL?D=oe:D=ae;async function se(e,t){let{response:n,binary:i}=D(e,t);if(i)return i;let r=await n;if(!r.ok)throw new Error(`Failed to load '${e}': request failed.`);return new Uint8Array(await r.arrayBuffer())}a(se,"loadBinaryFile");var P;if(p.IN_BROWSER_MAIN_THREAD)P=a(async e=>await import(e),"loadScript");else if(p.IN_BROWSER_WEB_WORKER)P=a(async e=>{try{globalThis.importScripts(e)}catch(t){if(t instanceof TypeError)await import(e);else throw t}},"loadScript");else if(p.IN_NODE)P=le;else if(p.IN_SHELL)P=load;else throw new Error("Cannot determine runtime environment");async function le(e){e.startsWith("file://")&&(e=e.slice(7)),e.includes("://")?te.runInThisContext(await(await fetch(e)).text()):await import(ee.pathToFileURL(e).href)}a(le,"nodeLoadScript");async function ce(e){if(p.IN_NODE){await V();let t=await H.readFile(e,{encoding:"utf8"});return JSON.parse(t)}else if(p.IN_SHELL){let t=read(e);return JSON.parse(t)}else return await(await fetch(e)).json()}a(ce,"loadLockFile");async function ue(){if(p.IN_NODE_COMMONJS)return __dirname;let e;try{throw new Error}catch(i){e=i}let t=We.parse(e)[0].fileName;if(p.IN_NODE&&!t.startsWith("file://")&&(t=`file://${t}`),p.IN_NODE_ESM){let i=await import("./__vite-browser-external-9wXp6ZBx.js");return(await import("./__vite-browser-external-9wXp6ZBx.js")).fileURLToPath(i.dirname(t))}let n=t.lastIndexOf(q);if(n===-1)throw new Error("Could not extract indexURL path from pyodide module location. Please pass the indexURL explicitly to loadPyodide.");return t.slice(0,n)}a(ue,"calculateDirname");function fe(e){return e.substring(0,e.lastIndexOf("/")+1)||globalThis.location?.toString()||"."}a(fe,"calculateInstallBaseUrl");function de(e){let t=e.FS,n=e.FS.filesystems.MEMFS,i=e.PATH,r={DIR_MODE:16895,FILE_MODE:33279,mount:a(function(o){if(!o.opts.fileSystemHandle)throw new Error("opts.fileSystemHandle is required");return n.mount.apply(null,arguments)},"mount"),syncfs:a(async(o,s,l)=>{try{let c=r.getLocalSet(o),u=await r.getRemoteSet(o),d=s?u:c,g=s?c:u;await r.reconcile(o,d,g),l(null)}catch(c){l(c)}},"syncfs"),getLocalSet:a(o=>{let s=Object.create(null);function l(d){return d!=="."&&d!==".."}a(l,"isRealDir");function c(d){return g=>i.join2(d,g)}a(c,"toAbsolute");let u=t.readdir(o.mountpoint).filter(l).map(c(o.mountpoint));for(;u.length;){let d=u.pop(),g=t.stat(d);t.isDir(g.mode)&&u.push.apply(u,t.readdir(d).filter(l).map(c(d))),s[d]={timestamp:g.mtime,mode:g.mode}}return{type:"local",entries:s}},"getLocalSet"),getRemoteSet:a(async o=>{let s=Object.create(null),l=await $e(o.opts.fileSystemHandle);for(let[c,u]of l)c!=="."&&(s[i.join2(o.mountpoint,c)]={timestamp:u.kind==="file"?new Date((await u.getFile()).lastModified):new Date,mode:u.kind==="file"?r.FILE_MODE:r.DIR_MODE});return{type:"remote",entries:s,handles:l}},"getRemoteSet"),loadLocalEntry:a(o=>{let s=t.lookupPath(o,{}).node,l=t.stat(o);if(t.isDir(l.mode))return{timestamp:l.mtime,mode:l.mode};if(t.isFile(l.mode))return s.contents=n.getFileDataAsTypedArray(s),{timestamp:l.mtime,mode:l.mode,contents:s.contents};throw new Error("node type not supported")},"loadLocalEntry"),storeLocalEntry:a((o,s)=>{if(t.isDir(s.mode))t.mkdirTree(o,s.mode);else if(t.isFile(s.mode))t.writeFile(o,s.contents,{canOwn:!0});else throw new Error("node type not supported");t.chmod(o,s.mode),t.utime(o,s.timestamp,s.timestamp)},"storeLocalEntry"),removeLocalEntry:a(o=>{var s=t.stat(o);t.isDir(s.mode)?t.rmdir(o):t.isFile(s.mode)&&t.unlink(o)},"removeLocalEntry"),loadRemoteEntry:a(async o=>{if(o.kind==="file"){let s=await o.getFile();return{contents:new Uint8Array(await s.arrayBuffer()),mode:r.FILE_MODE,timestamp:new Date(s.lastModified)}}else{if(o.kind==="directory")return{mode:r.DIR_MODE,timestamp:new Date};throw new Error("unknown kind: "+o.kind)}},"loadRemoteEntry"),storeRemoteEntry:a(async(o,s,l)=>{let c=o.get(i.dirname(s)),u=t.isFile(l.mode)?await c.getFileHandle(i.basename(s),{create:!0}):await c.getDirectoryHandle(i.basename(s),{create:!0});if(u.kind==="file"){let d=await u.createWritable();await d.write(l.contents),await d.close()}o.set(s,u)},"storeRemoteEntry"),removeRemoteEntry:a(async(o,s)=>{await o.get(i.dirname(s)).removeEntry(i.basename(s)),o.delete(s)},"removeRemoteEntry"),reconcile:a(async(o,s,l)=>{let c=0,u=[];Object.keys(s.entries).forEach(function(y){let E=s.entries[y],A=l.entries[y];(!A||t.isFile(E.mode)&&E.timestamp.getTime()>A.timestamp.getTime())&&(u.push(y),c++)}),u.sort();let d=[];if(Object.keys(l.entries).forEach(function(y){s.entries[y]||(d.push(y),c++)}),d.sort().reverse(),!c)return;let g=s.type==="remote"?s.handles:l.handles;for(let y of u){let E=i.normalize(y.replace(o.mountpoint,"/")).substring(1);if(l.type==="local"){let A=g.get(E),Re=await r.loadRemoteEntry(A);r.storeLocalEntry(y,Re)}else{let A=r.loadLocalEntry(y);await r.storeRemoteEntry(g,E,A)}}for(let y of d)if(l.type==="local")r.removeLocalEntry(y);else{let E=i.normalize(y.replace(o.mountpoint,"/")).substring(1);await r.removeRemoteEntry(g,E)}},"reconcile")};e.FS.filesystems.NATIVEFS_ASYNC=r}a(de,"initializeNativeFS");var $e=a(async e=>{let t=[];async function n(r){for await(let o of r.values())t.push(o),o.kind==="directory"&&await n(o)}a(n,"collect"),await n(e);let i=new Map;i.set(".",e);for(let r of t){let o=(await e.resolve(r)).join("/");i.set(o,r)}return i},"getFsHandles"),je=Ce("AGFzbQEAAAABDANfAGAAAW9gAW8BfwMDAgECByECD2NyZWF0ZV9zZW50aW5lbAAAC2lzX3NlbnRpbmVsAAEKEwIHAPsBAPsbCwkAIAD7GvsUAAs="),ze=(async function(){if(!(globalThis.navigator&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&typeof navigator.maxTouchPoints<"u"&&navigator.maxTouchPoints>1)))try{let e=await WebAssembly.compile(je);return await WebAssembly.instantiate(e)}catch(e){if(e instanceof WebAssembly.CompileError)return;throw e}})();async function pe(){let e=await ze;if(e)return e.exports;let t=Symbol("error marker");return{create_sentinel:a(()=>t,"create_sentinel"),is_sentinel:a(n=>n===t,"is_sentinel")}}a(pe,"getSentinelImport");function ye(e){let t={config:e,runtimeEnv:p},n={noImageDecoding:!0,noAudioDecoding:!0,noWasmDecoding:!1,preRun:ve(e),print:e.stdout,printErr:e.stderr,onExit(i){n.exitCode=i},thisProgram:e._sysExecutable,arguments:e.args,API:t,locateFile:a(i=>e.indexURL+i,"locateFile"),instantiateWasm:Ee(e.indexURL)};return n}a(ye,"createSettings");function me(e){return function(t){let n="/";try{t.FS.mkdirTree(e)}catch(i){console.error(`Error occurred while making a home directory '${e}':`),console.error(i),console.error(`Using '${n}' for a home directory instead`),e=n}t.FS.chdir(e)}}a(me,"createHomeDirectory");function ge(e){return function(t){Object.assign(t.ENV,e)}}a(ge,"setEnvironment");function we(e){return e?[async t=>{t.addRunDependency("fsInitHook");try{await e(t.FS,{sitePackages:t.API.sitePackages})}finally{t.removeRunDependency("fsInitHook")}}]:[]}a(we,"callFsInitHook");function he(e){let t=e.HEAPU32[e._Py_Version>>>2],n=t>>>24&255,i=t>>>16&255,r=t>>>8&255;return[n,i,r]}a(he,"computeVersionTuple");function be(e){let t=se(e);return async n=>{n.API.pyVersionTuple=he(n);let[i,r]=n.API.pyVersionTuple;n.FS.mkdirTree("/lib"),n.API.sitePackages=`/lib/python${i}.${r}/site-packages`,n.FS.mkdirTree(n.API.sitePackages),n.addRunDependency("install-stdlib");try{let o=await t;n.FS.writeFile(`/lib/python${i}${r}.zip`,o)}catch(o){console.error("Error occurred while installing the standard library:"),console.error(o)}finally{n.removeRunDependency("install-stdlib")}}}a(be,"installStdlib");function ve(e){let t;return e.stdLibURL!=null?t=e.stdLibURL:t=e.indexURL+"python_stdlib.zip",[be(t),me(e.env.HOME),ge(e.env),de,...we(e.fsInit)]}a(ve,"getFileSystemInitializationFuncs");function Ee(e){if(typeof WasmOffsetConverter<"u")return;let{binary:t,response:n}=D(e+"pyodide.asm.wasm"),i=pe();return function(r,o){return(async function(){r.sentinel=await i;try{let s;n?s=await WebAssembly.instantiateStreaming(n,r):s=await WebAssembly.instantiate(await t,r);let{instance:l,module:c}=s;o(l,c)}catch(s){console.warn("wasm instantiation failed!"),console.warn(s)}})(),{}}}a(Ee,"getInstantiateWasmFunc");var He="0.29.0";function F(e){return e===void 0||e.endsWith("/")?e:e+"/"}a(F,"withTrailingSlash");var W=He;async function Se(e={}){if(await V(),e.lockFileContents&&e.lockFileURL)throw new Error("Can't pass both lockFileContents and lockFileURL");let t=e.indexURL||await ue();if(t=F(R(t)),e.packageBaseUrl=F(e.packageBaseUrl),e.cdnUrl=F(e.packageBaseUrl??`https://cdn.jsdelivr.net/pyodide/v${W}/full/`),!e.lockFileContents){let r=e.lockFileURL??t+"pyodide-lock.json";e.lockFileContents=ce(r),e.packageBaseUrl??=fe(r)}e.indexURL=t,e.packageCacheDir&&(e.packageCacheDir=F(R(e.packageCacheDir)));let n={fullStdLib:!1,jsglobals:globalThis,stdin:globalThis.prompt?()=>globalThis.prompt():void 0,args:[],env:{},packages:[],packageCacheDir:e.packageBaseUrl,enableRunUntilComplete:!0,checkAPIVersion:!0,BUILD_ID:"761936574707325565bed16f46bb59050f9a5477dab28ba3db09f3fb41ea89e7"},i=Object.assign(n,e);return i.env.HOME??="/home/pyodide",i.env.PYTHONINSPECT??="1",i}a(Se,"initializeConfiguration");function Ne(e){let t=ye(e),n=t.API;return n.lockFilePromise=Promise.resolve(e.lockFileContents),t}a(Ne,"createEmscriptenSettings");async function ke(e){if(typeof _createPyodideModule!="function"){let t=`${e.indexURL}pyodide.asm.js`;await P(t)}}a(ke,"loadWasmScript");async function Ae(e,t){if(!e._loadSnapshot)return;let n=await e._loadSnapshot,i=ArrayBuffer.isView(n)?n:new Uint8Array(n);return t.noInitialRun=!0,t.INITIAL_MEMORY=i.length,i}a(Ae,"prepareSnapshot");async function Ie(e){let t=await _createPyodideModule(e);if(e.exitCode!==void 0)throw new t.ExitStatus(e.exitCode);return t}a(Ie,"createPyodideModule");function Oe(e,t){let n=e.API;if(t.pyproxyToStringRepr&&n.setPyProxyToStringMethod(!0),t.convertNullToNone&&n.setCompatNullToNone(!0),t.toJsLiteralMap&&n.setCompatToJsLiteralMap(!0),n.version!==W&&t.checkAPIVersion)throw new Error(`Pyodide version does not match: '${W}' <==> '${n.version}'. If you updated the Pyodide version, make sure you also updated the 'indexURL' parameter passed to loadPyodide.`);e.locateFile=i=>{throw i.endsWith(".so")?new Error(`Failed to find dynamic library "${i}"`):new Error(`Unexpected call to locateFile("${i}")`)}}a(Oe,"configureAPI");function _e(e,t,n){let i=e.API,r;return t&&(r=i.restoreSnapshot(t)),i.finalizeBootstrap(r,n._snapshotDeserializer)}a(_e,"bootstrapPyodide");async function Pe(e,t){let n=e._api;return n.sys.path.insert(0,""),n._pyodide.set_excepthook(),await n.packageIndexReady,n.initializeStreams(t.stdin,t.stdout,t.stderr),e}a(Pe,"finalizeSetup");async function Fe(e={}){let t=await Se(e),n=Ne(t);await ke(t);let i=await Ae(t,n),r=await Ie(n);Oe(r,t);let o=_e(r,i,t);return await Pe(o,t)}a(Fe,"loadPyodide");let f=null,$=null,w=null,Ve=0;const j=new Map,L={log:console.log.bind(console),info:console.info.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),debug:console.debug.bind(console)};function x(e){if(e===null)return"null";if(e===void 0)return"undefined";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);if(e instanceof Error)return`${e.name}: ${e.message}`;try{return JSON.stringify(e)}catch{return String(e)}}console.log=function(...e){L.log.apply(console,e),self.postMessage({id:"console-log",type:"console",payload:{level:"info",message:e.map(t=>x(t)).join(" ")}})};console.info=function(...e){L.info.apply(console,e),self.postMessage({id:"console-log",type:"console",payload:{level:"info",message:e.map(t=>x(t)).join(" ")}})};console.warn=function(...e){L.warn.apply(console,e),self.postMessage({id:"console-log",type:"console",payload:{level:"warning",message:e.map(t=>x(t)).join(" ")}})};console.error=function(...e){L.error.apply(console,e),self.postMessage({id:"console-log",type:"console",payload:{level:"error",message:e.map(t=>x(t)).join(" ")}})};console.debug=function(...e){L.debug.apply(console,e),self.postMessage({id:"console-log",type:"console",payload:{level:"debug",message:e.map(t=>x(t)).join(" ")}})};const v=[];function h(e){self.postMessage(e)}async function qe(e){const t=xe.version;if(f=await Fe({indexURL:`https://cdn.jsdelivr.net/pyodide/v${t}/full/`}),typeof SharedArrayBuffer<"u")try{const n=new SharedArrayBuffer(1);w=new Uint8Array(n),f.setInterruptBuffer(w),h({id:"interrupt-buffer",type:"success",payload:n})}catch(n){console.warn("Failed to set up interrupt buffer:",n),h({id:"interrupt-buffer",type:"error",payload:{message:"SharedArrayBuffer not available"}})}else console.warn("SharedArrayBuffer not available - interrupt functionality will be limited"),h({id:"interrupt-buffer",type:"error",payload:{message:"SharedArrayBuffer not available"}});if(f.globals.set("input",n=>{const i=`input-${Ve++}`;return h({id:i,type:"inputRequest",payload:{prompt:n||""}}),new Promise((r,o)=>{j.set(i,{resolve:r,reject:o})})}),f.setStderr({batched:n=>{v.push(n),h({id:"stream",type:"stderr",payload:n})}}),f.setStdout({batched:n=>{v.push(n),h({id:"stream",type:"stdout",payload:n})}}),e.vars)for(const[n,i]of Object.entries(e.vars))f.globals.set(n,i)}async function Je(e){if(!f)throw new Error("Pyodide not initialized");const t=e.mountPoint||"/workspace";$=await f.mountNativeFS(t,e.handle),f.runPython(`import os, sys; sys.path.append('${t}'); os.chdir("${t}");`)}async function Ge(e){if(!f)throw new Error("Pyodide not initialized");const t=e.requirements.split(`
`).map(n=>n.trim()).filter(n=>n&&!n.startsWith("#"));t.length>0&&await f.loadPackage(t,{checkIntegrity:!1})}async function Ke(e){if(!f)throw new Error("Pyodide not initialized");e.packages.length>0&&await f.loadPackage(e.packages,{checkIntegrity:!1})}function J(e){if(e==null)return e;const t=typeof e;if(t==="string"||t==="number"||t==="boolean")return e;if(e&&typeof e=="object"){if(typeof e.toJs=="function")try{const n=e.toJs({dict_converter:Object.fromEntries,create_pyproxies:!1});return typeof e.destroy=="function"&&e.destroy(),n}catch{try{const i=String(e);return typeof e.destroy=="function"&&e.destroy(),i}catch{return"[Python object]"}}try{return structuredClone(e),e}catch{try{return JSON.parse(JSON.stringify(e))}catch{return String(e)}}}return e}async function Ye(e){if(!f)throw new Error("Pyodide not initialized");v.length=0,w&&(w[0]=0);let t;try{t=await f.runPythonAsync(e.code)}catch(n){throw w&&(w[0]=0),n}return w&&(w[0]=0),await M(),{result:J(t),console:v.slice()}}async function Ze(e){if(!f)throw new Error("Pyodide not initialized");v.length=0;const t=f.pyimport(e.moduleName),n=e.entryName??"main";let i;if(n in t){const r=t[n];if(!(r instanceof Function))throw new Error(`Module entry point is not a function: ${n}`);i=r.callKwargs(e.vars||{})}return await M(),{result:J(i),console:v.slice()}}async function Qe(e){if(!f)throw new Error("Pyodide not initialized");v.length=0;const t=f.globals.get(e.name),n=t.callKwargs(e.args);return t.destroy(),await M(),{result:J(n),console:v.slice()}}async function Xe(e){if(!f)throw new Error("Pyodide not initialized");f.globals.set(e.key,e.value)}async function M(){$&&await $.syncfs()}async function et(){if(!f)throw new Error("Pyodide not initialized");return String(f.version)}self.onmessage=async e=>{const{id:t,type:n,payload:i}=e.data;if(n==="inputResponse"){const r=j.get(t);r&&(j.delete(t),i.cancelled?r.resolve(""):r.resolve(i.value||""));return}try{let r;switch(n){case"init":await qe(i),r={initialized:!0};break;case"mountWorkspace":await Je(i),r={mounted:!0};break;case"installDependencies":await Ge(i),r={installed:!0};break;case"loadPackages":await Ke(i),r={loaded:!0};break;case"execCode":r=await Ye(i);break;case"execModule":r=await Ze(i);break;case"runFunction":r=await Qe(i);break;case"setGlobal":await Xe(i),r={set:!0};break;case"syncWorkspace":await M(),r={synced:!0};break;case"getVersion":r=await et();break;default:throw new Error(`Unknown message type: ${n}`)}h({id:t,type:"success",payload:r})}catch(r){h({id:t,type:"error",payload:{message:r instanceof Error?r.message:String(r),stack:r instanceof Error?r.stack:void 0}})}}});export default tt();
